<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>–ó–∞ –æ–∫–Ω–æ–º ‚Ä¢ –ö—É—Ä–≥–∞–Ω</title>

  <!-- PWA -->

  <meta name="theme-color" content="#020617">
  <link rel="apple-touch-icon" href="icon-192.png">

  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">

  <style>
    :root {
      --bg-night:   radial-gradient(circle at 50% 0%, #1e293b 0%, #020617 80%);
      --bg-dawn:    radial-gradient(circle at 50% 0%, #334155 0%, #0f172a 70%, #020617 100%);
      --bg-day:     radial-gradient(circle at 50% 0%, #60a5fa 0%, #1e40af 70%, #020617 100%);
      --bg-dusk:    radial-gradient(circle at 50% 0%, #f97316 0%, #7c3aed 40%, #020617 80%);
      --bg-extreme: radial-gradient(circle at 50% 0%, #0a0f1a 0%, #000000 80%);

      --accent: #38bdf8;
      --accent-day: #38bdf8;
      --accent-night: #a5b4fc;
      --accent-dawn: #7dd3fc;
      --accent-dusk: #fb923c;
      --accent-cold: #a5f3fc;

      --card-bg: rgba(15, 23, 42, 0.82);
      --card-border: 1px solid rgba(255, 255, 255, 0.16);
      --card-radius: 24px;

      --text-main: #f8fafc;
      --text-muted: #94a3b8;
    }

    body {
      margin: 0;
      background: var(--bg-night);
      background-image: var(--bg-night);
      color: var(--text-main);
      font-family: 'Inter', sans-serif;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      overflow-x: hidden;
      transition: background 1.2s ease;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      touch-action: manipulation;
    }

    body.day    { background: linear-gradient(180deg, #60a5fa, #3b82f6);    --accent: var(--accent-day);    --text-muted: #e0f2fe; }
    body.dawn   { background-image: var(--bg-dawn);   --accent: var(--accent-dawn);   --text-muted: #e2e8f0; }
    body.dusk   { background-image: var(--bg-dusk);   --accent: var(--accent-dusk);   --text-muted: #cbd5e1; }
    body.night  { background-image: var(--bg-night);  --accent: var(--accent-night);  --text-muted: #94a3b8; }
    body.extreme{ background-image: var(--bg-extreme); --card-bg: rgba(5,10,20,0.92); --text-main: #e2e8f0; }

    * { box-sizing: border-box; margin:0; padding:0; -webkit-tap-highlight-color: transparent; }

    canvas#star-canvas, canvas#snow-canvas {
      position: fixed;
      inset: 0;
      z-index: 0;
      pointer-events: none;
    }

    .container {
      width: 100%;
      max-width: 640px;
      padding: clamp(16px, 5vw, 32px) 16px 120px;
      z-index: 10;
      display: flex;
      flex-direction: column;
      gap: clamp(24px, 7vw, 48px);
    }

    .hero {
      text-align: center;
      padding: clamp(60px, 16vh, 120px) 0 40px 0;
      opacity: 0;
      animation: fadeIn 1.4s forwards 0.4s;
    }

    @keyframes fadeIn { to { opacity: 1; } }

    .app-title {
      text-align: center;
      margin-bottom: 24px;
    }

    .app-name {
      font-size: clamp(1.8rem, 6.5vw, 2.4rem);
      font-weight: 800;
      letter-spacing: 0.14em;
      text-transform: lowercase;
      color: white;
      text-shadow: 0 4px 18px rgba(0,0,0,.3);
    }

    .app-city {
      margin-top: 5px;
      font-size: clamp(0.9rem, 3.2vw, 1.05rem);
      font-weight: 500;
      letter-spacing: 0.20em;
      text-transform: uppercase;
      color: rgba(255,255,255,0.68);
    }

    .current-weather {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 16px;
      flex-wrap: nowrap;
      white-space: nowrap;
    }

    .main-icon {
      font-size: clamp(5.5rem, 20vw, 9rem);
      line-height: 1;
      filter: drop-shadow(0 12px 48px rgba(0,0,0,0.65));
    }

    .temp {
      display: flex;
      align-items: flex-start;
      justify-content: center;
      gap: 6px;
      line-height: 1;
    }

    .temp-value {
      font-size: clamp(6.8rem, 22vw, 11rem);
      font-weight: 800;
      letter-spacing: -0.08em;
      color: white;
      text-shadow:
        0 8px 32px rgba(0,0,0,.35),
        0 3px 12px rgba(0,0,0,.25);
    }

    .temp-unit {
      font-size: clamp(2.8rem, 9vw, 4.2rem);
      font-weight: 500;
      margin-top: clamp(12px, 3vw, 22px);
      opacity: 0.78;
      letter-spacing: -0.02em;
    }

    .feels-like {
      margin-top: 8px;
      font-size: clamp(1.05rem, 3.8vw, 1.18rem);
      font-weight: 500;
      color: rgba(255,255,255,0.78);
      letter-spacing: -0.01em;
    }

    body.extreme .feels-like {
      color: #fca5a5;
      font-weight: 600;
    }

    .last-update {
      font-size: clamp(0.85rem, 3.2vw, 1rem);
      color: var(--text-muted);
      margin-top: 16px;
      opacity: 0.85;
    }

    /* ‚îÄ‚îÄ‚îÄ –£–ª—É—á—à–µ–Ω–Ω—ã–π –≤–∏–¥–∂–µ—Ç –≤–µ—Ç—Ä–∞ ‚îÄ‚îÄ‚îÄ */
    .wind-compass {
      position: relative;
      width: 120px;
      height: 120px;
      margin: 0 auto;
    }

    .wind-compass span {
      position: absolute;
      font-size: 0.75rem;
      font-weight: 600;
      color: rgba(255,255,255,.7);
    }

    .wind-compass .n { top: -6px; left: 50%; transform: translateX(-50%); }
    .wind-compass .s { bottom: -6px; left: 50%; transform: translateX(-50%); }
    .wind-compass .e { right: -6px; top: 50%; transform: translateY(-50%); }
    .wind-compass .w { left: -6px; top: 50%; transform: translateY(-50%); }

    .wind-arrow {
      position: absolute;
      top: 50%;
      left: 50%;
      width: 2px;
      height: 42px;
      background: var(--accent);
      transform-origin: bottom center;
      transform: translate(-50%, -100%) rotate(0deg);
      border-radius: 2px;
      box-shadow: 0 0 10px var(--accent);
      transition: transform 0.6s ease;
    }

    /* –ü–æ—á–∞—Å–æ–≤–æ–π –∏ –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ –æ—Å—Ç–∞—é—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π */
    .hourly-wrapper { position: relative; }
    .hourly-container {
      display: flex;
      gap: 12px;
      overflow-x: auto;
      padding: 16px 0 28px;
      -webkit-overflow-scrolling: touch;
      scrollbar-width: none;
    }
    .hourly-container::-webkit-scrollbar { display: none; }

    .hour-card {
      min-width: clamp(78px, 21vw, 98px);
      background: var(--card-bg);
      border: var(--card-border);
      border-radius: 20px;
      padding: 14px 8px;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 8px;
      backdrop-filter: blur(20px);
      transition: transform 0.2s ease;
      flex-shrink: 0;
      opacity: 0;
      animation: cardIn 0.6s ease forwards;
    }

    .hour-card:active { transform: scale(1.08); }

    .h-time { font-size: 0.78rem; font-weight: 900; color: var(--text-muted); text-transform: uppercase; }
    .h-icon  { font-size: clamp(1.9rem, 6vw, 2.5rem); }
    .h-temp  { font-size: clamp(1.45rem, 5vw, 1.9rem); font-weight: 900; }

    .widgets-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 16px;
    }

    .widget {
      background: var(--card-bg);
      border: var(--card-border);
      backdrop-filter: blur(20px);
      border-radius: var(--card-radius);
      padding: 20px;
      display: flex;
      flex-direction: column;
      gap: 12px;
      min-height: 170px;
      opacity: 0;
      animation: cardIn 0.6s ease forwards;
    }

    .w-label {
      font-size: 0.82rem;
      font-weight: 900;
      color: var(--text-muted);
      text-transform: uppercase;
      letter-spacing: 1px;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .w-label::before {
      content: attr(data-icon);
      font-size: 1rem;
      opacity: 0.8;
    }

    .w-main { flex: 1; display: flex; align-items: center; justify-content: center; }

    .hum-circle-box {
      width: clamp(90px, 26vw, 120px);
      height: clamp(90px, 26vw, 120px);
      position: relative;
    }
    .hum-svg { transform: rotate(-90deg); width: 100%; height: 100%; }
    .hum-bg { fill: none; stroke: rgba(255,255,255,0.1); stroke-width: 8; }
    .hum-fill {
      fill: none;
      stroke: var(--accent);
      stroke-width: 8;
      stroke-linecap: round;
      transition: stroke-dashoffset 1.8s ease;
    }
    .hum-percent {
      position: absolute;
      inset: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: clamp(1.7rem, 5.5vw, 2.2rem);
      font-weight: 900;
    }

    .sun-widget {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 8px;
    }
    .sun-arc {
      position: relative;
      width: 100%;
      height: 90px;
      margin-bottom: 6px;
    }
    .sun-path {
      position: absolute;
      left: 10px; right: 10px; bottom: 0;
      height: 90px;
      border-top: 2px dashed rgba(255,255,255,.25);
      border-radius: 100% 100% 0 0;
    }
    .sun-dot {
      position: absolute;
      bottom: 0;
      left: 50%;
      transform: translateX(-50%);
      font-size: 1.8rem;
      filter: drop-shadow(0 0 14px var(--accent));
      transition: left 1.8s ease, opacity 1.2s ease;
    }
    .sun-times {
      display: flex;
      justify-content: space-around;
      width: 100%;
      font-size: 1.2rem;
      font-weight: 700;
    }
    .sun-icon { font-size: 2.5rem; color: var(--accent); }

    .forecast-card {
      background: var(--card-bg);
      border: var(--card-border);
      backdrop-filter: blur(20px);
      border-radius: var(--card-radius);
      padding: 24px 16px;
      opacity: 0;
      animation: cardIn 0.8s ease forwards;
    }

    .f-table-header, .f-row {
      display: grid;
      grid-template-columns: 2fr 1fr 1fr;
      align-items: center;
      text-align: center;
    }
    .f-table-header {
      font-size: 0.78rem;
      font-weight: 900;
      color: var(--text-muted);
      text-transform: uppercase;
      padding-bottom: 12px;
      border-bottom: 1px solid rgba(255,255,255,0.12);
    }
    .f-row {
      padding: 14px 0;
      border-bottom: 1px solid rgba(255,255,255,0.08);
    }
    .f-row:last-child { border-bottom: none; }

    .f-info {
      display: flex;
      align-items: center;
      gap: 12px;
      text-align: left;
    }
    .f-icon { font-size: clamp(1.9rem, 5.5vw, 2.3rem); }
    .f-day-name { font-weight: 900; font-size: clamp(1rem, 3.8vw, 1.15rem); text-transform: uppercase; }
    .f-date-sub { font-size: 0.78rem; color: var(--text-muted); }
    .f-temp-day   { font-size: clamp(1.35rem, 5vw, 1.7rem); font-weight: 900; }
    .f-temp-night { font-size: clamp(1.25rem, 4.5vw, 1.55rem); font-weight: 900; color: var(--text-muted); }

    @keyframes cardIn {
      from { opacity:0; transform:translateY(24px) scale(0.97); filter:blur(6px); }
      to   { opacity:1; transform:none; filter:none; }
    }

    @media (max-width: 480px) {
      .container { padding: 16px 12px 120px; }
      .widgets-grid { grid-template-columns: 1fr; }
      .wind-compass { width: 100px; height: 100px; }
      .wind-arrow { height: 36px; }
    }
  </style>
</head>
<body class="night">

<canvas id="star-canvas"></canvas>
<canvas id="snow-canvas"></canvas>

<div class="container">

  <header class="hero">
    <div class="app-title">
      <div class="app-name">–∑–∞–û–∫–Ω–æ–º</div>
      <div class="app-city">–ö—É—Ä–≥–∞–Ω</div>
    </div>

    <div class="current-weather">
      <div class="main-icon" id="current-icon">‚è≥</div>
      <div class="temp" id="temp-now-wrapper">
        <span class="temp-value" id="temp-now">‚Äì</span>
        <span class="temp-unit">¬∞C</span>
      </div>
    </div>

    <div class="feels-like" id="feels-now">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
    <div class="last-update" id="update-time"></div>
  </header>

  <div class="hourly-wrapper">
    <div class="hourly-container" id="hourly-list">
      <div style="padding:60px 20px; color:var(--text-muted); text-align:center; width:100%;">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
    </div>
  </div>

  <div class="widgets-grid">

    <div class="widget">
      <div class="w-label" data-icon="üß≠">–í–ï–¢–ï–†</div>
      <div class="w-main">
        <div class="wind-compass">
          <span class="n">–°</span>
          <span class="e">–í</span>
          <span class="s">–Æ</span>
          <span class="w">–ó</span>
          <div class="wind-arrow" id="wind-arrow"></div>
        </div>
      </div>
      <div style="text-align:center; margin-top:12px;">
        <span id="wind-speed" style="font-size:2.4rem; font-weight:900;">‚Äì</span>
        <span style="font-size:1rem; color:var(--text-muted);"> –º/—Å</span>
      </div>
    </div>

    <div class="widget">
      <div class="w-label" data-icon="üíß">–í–õ–ê–ñ–ù–û–°–¢–¨</div>
      <div class="w-main">
        <div class="hum-circle-box">
          <svg class="hum-svg" viewBox="0 0 100 100">
            <circle class="hum-bg"   cx="50" cy="50" r="44"/>
            <circle id="hum-bar" class="hum-fill" cx="50" cy="50" r="44" stroke-dasharray="276" stroke-dashoffset="276"/>
          </svg>
          <div class="hum-percent" id="hum-val">‚Äì%</div>
        </div>
      </div>
      <div style="text-align:center; font-size:0.88rem; color:var(--accent); font-weight:900;">
        –¢–û–ß–ö–ê –†–û–°–´ <span id="dew-val">‚Äì</span>¬∞C
      </div>
    </div>

    <div class="widget">
      <div class="w-label" data-icon="üåÖ">–°–û–õ–ù–¶–ï</div>
      <div class="w-main sun-widget">
        <div class="sun-arc">
          <div class="sun-path"></div>
          <div class="sun-dot" id="sun-dot">‚òÄÔ∏è</div>
        </div>

        <div class="sun-times">
          <span>–í–æ—Å—Ö–æ–¥: <span id="sunrise-time">--:--</span></span>
          <span>–ó–∞–∫–∞—Ç: <span id="sunset-time">--:--</span></span>
        </div>
      </div>
    </div>

    <div class="widget" style="grid-column: 1 / -1;">
      <div class="w-label" data-icon="‚è≤Ô∏è">–î–ê–í–õ–ï–ù–ò–ï</div>
      <div class="w-main" style="gap:14px;">
        <span id="press-val" style="font-size:3.2rem; font-weight:900;">‚Äì</span>
        <span style="font-size:1.3rem; color:var(--text-muted);">–º–º —Ä—Ç. —Å—Ç.</span>
      </div>
    </div>

  </div>

  <div class="forecast-card">
    <div class="w-label" style="margin-bottom:20px;">üìÖ –ü–†–û–ì–ù–û–ó –ù–ê 14 –î–ù–ï–ô</div>
    <div class="f-table-header">
      <div style="text-align:left;">–î–ï–ù–¨</div>
      <div>–î–ï–ù–¨</div>
      <div>–ù–û–ß–¨</div>
    </div>
    <div id="forecast-list">
      <div style="padding:60px 20px; color:var(--text-muted); text-align:center;">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
    </div>
  </div>

</div>

<script>
// API –∏ –∏–∫–æ–Ω–∫–∏
const API_URL = "https://api.open-meteo.com/v1/forecast?latitude=55.44&longitude=65.34&current=temperature_2m,relative_humidity_2m,apparent_temperature,weather_code,pressure_msl,wind_speed_10m,wind_direction_10m,dew_point_2m&hourly=temperature_2m,weather_code&daily=weather_code,temperature_2m_max,temperature_2m_min,sunrise,sunset&timezone=auto&forecast_days=14";

const WEATHER_ICONS = {
  0: "‚òÄÔ∏è", 1: "üå§Ô∏è", 2: "‚õÖ", 3: "‚òÅÔ∏è", 45: "üå´Ô∏è", 48: "üå´Ô∏è",
  51: "üå¶Ô∏è", 53: "üå¶Ô∏è", 55: "üåßÔ∏è", 56:"üåßÔ∏è‚ùÑÔ∏è", 57:"üåßÔ∏è‚ùÑÔ∏è",
  61: "üåßÔ∏è", 63: "üåßÔ∏è", 65: "üåßÔ∏è", 66:"üåßÔ∏è‚ùÑÔ∏è", 67:"üåßÔ∏è‚ùÑÔ∏è",
  71: "üå®Ô∏è", 73: "üå®Ô∏è", 75: "üå®Ô∏è", 77: "‚ùÑÔ∏è",
  80: "üå¶Ô∏è", 81: "üå¶Ô∏è", 82: "‚õàÔ∏è", 85: "üå®Ô∏è", 86: "üå®Ô∏è",
  95: "‚õàÔ∏è", 96: "‚õàÔ∏è‚ùÑÔ∏è", 99: "‚õàÔ∏è‚ùÑÔ∏è"
};
const fallbackIcon = "üå´Ô∏è";

async function fetchWeather() {
  try {
    const res = await fetch(API_URL);
    if (!res.ok) throw new Error();
    const data = await res.json();

    const nowDate = new Date();
    const updateTime = new Date(data.current.time);
    document.getElementById("update-time").textContent =
      `–û–±–Ω–æ–≤–ª–µ–Ω–æ: ${updateTime.toLocaleTimeString("ru-RU", {hour:"2-digit", minute:"2-digit"})}`;

    const temp  = Math.round(data.current.temperature_2m);
    const feels = Math.round(data.current.apparent_temperature);
    const code  = data.current.weather_code ?? 3;

    document.getElementById("temp-now").textContent = temp;
    document.getElementById("feels-now").textContent = `–û—â—É—â–∞–µ—Ç—Å—è –∫–∞–∫ ${feels}¬∞C`;
    document.getElementById("current-icon").textContent = WEATHER_ICONS[code] || fallbackIcon;

    document.body.classList.remove('extreme');
    if (temp <= -20 || feels <= -25) document.body.classList.add('extreme');

    // –í–µ—Ç–µ—Ä ‚Äî —Å–∫–æ—Ä–æ—Å—Ç—å + –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—Ç—Ä–µ–ª–∫–∏
    const windSpeed = Math.round(data.current.wind_speed_10m);
    const windDirection = data.current.wind_direction_10m;
    document.getElementById("wind-speed").textContent = windSpeed;
    document.getElementById("wind-arrow").style.transform =
      `translate(-50%, -100%) rotate(${windDirection}deg)`;

    // –í–ª–∞–∂–Ω–æ—Å—Ç—å
    const hum = data.current.relative_humidity_2m;
    document.getElementById("hum-val").textContent = hum + "%";
    const circ = 276;
    document.getElementById("hum-bar").style.strokeDashoffset = circ - (circ * hum / 100);
    document.getElementById("dew-val").textContent = Math.round(data.current.dew_point_2m);

    // –î–∞–≤–ª–µ–Ω–∏–µ
    const press_hPa = data.current.pressure_msl;
    const press_mmHg = Math.round(press_hPa * 0.750061683);
    document.getElementById("press-val").textContent = press_mmHg;

    // –í–æ—Å—Ö–æ–¥ / –∑–∞–∫–∞—Ç + –¥–µ–Ω—å/–Ω–æ—á—å –ø–æ —Ä–µ–∞–ª—å–Ω–æ–º—É —Å–æ–ª–Ω—Ü—É
    const sunrise = new Date(data.daily.sunrise[0]);
    const sunset  = new Date(data.daily.sunset[0]);
    document.getElementById("sunrise-time").textContent = sunrise.toLocaleTimeString("ru-RU", {hour:"2-digit", minute:"2-digit"});
    document.getElementById("sunset-time").textContent  = sunset.toLocaleTimeString("ru-RU", {hour:"2-digit", minute:"2-digit"});

    const now = Date.now();
    document.body.classList.remove('day', 'night');
    if (now > sunrise.getTime() && now < sunset.getTime()) {
      document.body.classList.add('day');
    } else {
      document.body.classList.add('night');
    }

    // –°–æ–ª–Ω–µ—á–Ω–∞—è —Ç–æ—á–∫–∞
    const dot = document.getElementById("sun-dot");
    if (now < sunrise.getTime() || now > sunset.getTime()) {
      dot.style.opacity = 0.3;
      dot.style.left = "50%";
    } else {
      dot.style.opacity = 1;
      const progress = (now - sunrise.getTime()) / (sunset.getTime() - sunrise.getTime());
      dot.style.left = `${10 + progress * 80}%`;
    }

    // –ü–æ—á–∞—Å–æ–≤–æ–π –∏ –ø—Ä–æ–≥–Ω–æ–∑ ‚Äî –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
    const hourlyList = document.getElementById("hourly-list");
    hourlyList.innerHTML = "";
    const hourlyTimes = data.hourly.time.map(t => new Date(t));
    let startIdx = hourlyTimes.findIndex(t => t >= nowDate);
    if (startIdx === -1) startIdx = 0;

    for (let i = 0; i < 24; i++) {
      const idx = (startIdx + i) % data.hourly.time.length;
      const t = hourlyTimes[idx];
      const hour = t.getHours();
      const isNow = i === 0;

      const card = document.createElement("div");
      card.className = "hour-card";
      card.innerHTML = `
        <div class="h-time">${isNow ? "–°–ï–ô–ß–ê–°" : hour.toString().padStart(2,"0") + ":00"}</div>
        <div class="h-icon">${WEATHER_ICONS[data.hourly.weather_code[idx]] || fallbackIcon}</div>
        <div class="h-temp">${Math.round(data.hourly.temperature_2m[idx])}¬∞</div>
      `;
      hourlyList.appendChild(card);
    }

    const forecastList = document.getElementById("forecast-list");
    forecastList.innerHTML = "";
    data.daily.time.forEach((dayStr, i) => {
      const date = new Date(dayStr);
      const dayName = i === 0 ? "–°–ï–ì–û–î–ù–Ø" : date.toLocaleDateString("ru-RU", {weekday:"short"}).toUpperCase();
      const sub = date.toLocaleDateString("ru-RU", {day:"numeric", month:"short"});

      const row = document.createElement("div");
      row.className = "f-row";
      row.innerHTML = `
        <div class="f-info">
          <span class="f-icon">${WEATHER_ICONS[data.daily.weather_code[i]] || fallbackIcon}</span>
          <div>
            <div class="f-day-name">${dayName}</div>
            <div class="f-date-sub">${sub}</div>
          </div>
        </div>
        <div class="f-temp-day">${Math.round(data.daily.temperature_2m_max[i])}¬∞</div>
        <div class="f-temp-night">${Math.round(data.daily.temperature_2m_min[i])}¬∞</div>
      `;
      forecastList.appendChild(row);
    });

  } catch (err) {
    console.error(err);
    document.getElementById("feels-now").textContent = "–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏";
    document.getElementById("hourly-list").innerHTML = `<div style="padding:80px 20px;color:#f87171;text-align:center;">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ–≥–æ–¥—ã</div>`;
    document.getElementById("forecast-list").innerHTML = `<div style="padding:80px 20px;color:#f87171;text-align:center;">–û—à–∏–±–∫–∞</div>`;
  }
}

// ‚îÄ‚îÄ‚îÄ –ß–∞—Å—Ç–∏—Ü—ã (–∑–≤—ë–∑–¥—ã + —Å–Ω–µ–≥) ‚îÄ‚îÄ‚îÄ
function initParticles() {
  const starCanvas = document.getElementById("star-canvas");
  const snowCanvas = document.getElementById("snow-canvas");
  const starCtx = starCanvas.getContext("2d");
  const snowCtx = snowCanvas.getContext("2d");

  let w, h, stars = [], snow = [];

  function resize() {
    w = starCanvas.width = snowCanvas.width = window.innerWidth;
    h = starCanvas.height = snowCanvas.height = window.innerHeight;
  }

  function createStars() {
    stars = [];
    const count = Math.floor((w * h) / 8000);
    for (let i = 0; i < count; i++) {
      stars.push({
        x: Math.random() * w,
        y: Math.random() * h,
        r: Math.random() * 1.3 + 0.3,
        a: Math.random() * 0.5 + 0.3,
        da: (Math.random() - 0.5) * 0.007
      });
    }
  }

  function createSnow() {
    snow = [];
    const count = Math.floor((w * h) / 14000);
    for (let i = 0; i < count; i++) {
      snow.push({
        x: Math.random() * w,
        y: Math.random() * -h * 1.5,
        r: Math.random() * 3 + 1,
        speed: Math.random() * 1.4 + 0.7,
        sway: Math.random() * 0.015 - 0.0075
      });
    }
  }

  function animate() {
    starCtx.clearRect(0, 0, w, h);
    snowCtx.clearRect(0, 0, w, h);

    stars.forEach(s => {
      starCtx.beginPath();
      starCtx.arc(s.x, s.y, s.r, 0, Math.PI * 2);
      starCtx.fillStyle = `rgba(240,240,255,${s.a})`;
      starCtx.fill();
      s.a += s.da;
      if (s.a > 0.95 || s.a < 0.25) s.da = -s.da;
    });

    const showSnow = document.body.classList.contains('night') ||
                     document.body.classList.contains('extreme');

    if (showSnow) {
      snow.forEach(p => {
        snowCtx.beginPath();
        snowCtx.arc(p.x, p.y, p.r, 0, Math.PI * 2);
        snowCtx.fillStyle = "rgba(255,255,255,0.88)";
        snowCtx.fill();

        p.y += p.speed;
        p.x += Math.sin(p.y * 0.008) * 1.8 + p.sway;

        if (p.y > h + 20) {
          p.y = -30;
          p.x = Math.random() * w;
        }
      });
    }

    requestAnimationFrame(animate);
  }

  window.addEventListener("resize", () => {
    resize();
    createStars();
    createSnow();
  });

  resize();
  createStars();
  createSnow();
  animate();
}

initParticles();
fetchWeather();
setInterval(fetchWeather, 600000);     // 10 –º–∏–Ω—É—Ç
</script>
</body>
</html>
